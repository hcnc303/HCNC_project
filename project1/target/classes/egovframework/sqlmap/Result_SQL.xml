<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >


<sqlMap namespace = "ResultSpace">
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="resultVO" type="egovframework.example.sample.service.ResultVO"/>
	<typeAlias  alias="inputVO" type="egovframework.example.sample.service.InputVO"/>
	
	<select id="resultDAO.selectResultDetail" resultClass="inputVO">
		select i.p_id, i.p_name, i.d_id, d.d_name, i.d_startdate, i.d_enddate 
		from hc_InputWorkers as i
		inner join hc_developer as d
		on i.d_id = d.d_id
		where i.p_id = #p_id# and i.d_id = #d_id#
	</select>
	
	<select id="resultDAO.selectResultModifyDetail" resultClass="resultVO">
		select no, p_id, d_id, d_startdate, d_enddate, year, jan, feb, mar, apr, may,jun, jul, aug, sep, oct, nov, dec
		from hc_result
		where p_id = #p_id# and d_id = #d_id# and year=#year#
	</select>
	
	<insert id="resultDAO.insertResult">
		insert into hc_result(p_id,p_name,d_id,d_name,d_startdate,d_enddate,year,jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec)
			values(#p_id#,#p_name#,#d_id#,#d_name#,#d_startdate#,#d_enddate#,#year#,#jan#,#feb#,#mar#,#apr#,#may#,#jun#,#jul#,#aug#,#sep#,#oct#,#nov#,#dec#)
	</insert>
	
	<select id="resultDAO.selectResultList" resultClass="egovMap">
		SELECT 
			p.p_id, p.p_name, p.p_startdate, p.p_enddate, p.p_buyer, p.p_progress, p.p_place, d.d_id, d.d_name,d.d_jobgrade, d.d_tier,i.i_role, i.i_stay, r.year,r.jan,r.feb,r.mar,r.apr,r.may,r.jun,r.jul,r.aug,r.sep,r.oct,r.nov,r.dec
			from hc_project as p
			inner join hc_InputWorkers as i
			on p.p_id = i.p_id 
			inner join hc_developer as d
			on d.d_id = i.d_id
			inner join hc_result as r
			on p.p_id = r.p_id and d.d_id = r.d_id
	</select>
	
	<update id="resultDAO.updateResult">
		update hc_result set
			jan=#jan#,feb=#feb#,mar=#mar#,apr=#apr#,may=#may#,jun=#jun#,jul=#jul#,aug=#aug#,sep=#sep#,oct=#oct#,nov=#nov#,dec=#dec#
		where no=#no#
	</update>
	
	<delete id="resultDAO.deleteResult">
		DELETE FROM hc_Result WHERE p_id=#p_id# AND d_id=#d_id# AND year=#year#
	</delete>
	
</sqlMap>